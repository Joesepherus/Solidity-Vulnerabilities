<h2>EGD Exploit</h2>
<div>
<p>
The attacker used a flash loan to alter the liquidity of the EGD/USDT trading pair, resulting in ClaimReward() getting an incorrect price, allowing the attacker to obtain an obscene amount of EGD tokens.
</p>
<p>
Pancakeswap uses the .pancakeCall() interface to perform a callback on the attackerâ€™s contract. You might be wondering how the attacker is executing different codes during each of the two callbacks.
</p>
<p>
The key is in the first flash loan, the attacker used 0x0000 in callback data.
</p>
<p>
However, during the second flash loan, the attacker used 0x00 in callback data.
</p>
<p>
<a href="https://github.com/finn79426/DeFiHackLabs/blob/main/src/test/EGD-Finance.exp.sol" target="_blank" rel="noopener noreferrer">
DeFiHackLabs - EGD-Finance.exp.sol
</a>
</p>
<p>
<a href="https://github.com/pancakeswap/pancake-swap-core/blob/master/contracts/PancakePair.sol" target="_blank" rel="noopener noreferrer">
PancakePair.sol
</a>
</p>
</div>


